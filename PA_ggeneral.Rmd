---
title: "PA_ggeneral"
author: "Gabriel General"
date: "31-01-2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading and preprocessing the data

```{r perAssignment, echo = TRUE}
DataFileName <- "./activity.zip"
dataDir <- "./data"


if (!file.exists(dataDir)) {
  dir.create(dataDir)
  unzip(zipfile = DataFileName, exdir = dataDir)
}


data <- read.csv("./data/activity.csv", header = TRUE, sep = ",")
data1 <- na.omit(data)


total <- as.numeric(nrow(data))
valid <- as.numeric(nrow(data1))
percent <- trunc((total - valid)*100/total)
steps <- data1$steps

```
There are `r percent`% of missing values ommited.

## What is mean total number of steps taken per day?


```{r}
hist(steps)
```


```{r meanperday, echo = TRUE, results = "asis"}



library(xtable)
library(dplyr)
meanPerDay <- aggregate(steps ~ date, data1, mean)
names(meanPerDay)[2] <- "meanSteps"
medianPerDay <- aggregate(steps ~ date, data1, median)
names(medianPerDay)[2] <- "medianSteps"
summarySteps <- merge(meanPerDay,medianPerDay, all = TRUE)
str(summarySteps)

tblMeanPerDay <- xtable(summarySteps)
print(tblMeanPerDay,type = "html")


```




## What is the average daily activity pattern?
```{r avgintervalperday, echo = TRUE, results = "asis"}
library(ggplot2)
library(dplyr)


meanStepInterval <- aggregate(steps ~ interval, data1, mean)
library(ggplot2)

ggplot(meanStepInterval, aes(interval, steps)) +
  geom_line() +
  theme(axis.text.x = element_text(angle=45, hjust=1, vjust = 1))


maxStepInterval <- meanStepInterval[which.max(meanStepInterval$steps),]
maxInterval <- maxStepInterval$interval
maxStep <- maxStepInterval$steps

```

2. Which 5-minute interval, on average across all the days in the dataset,
contains the maximum number of steps?

A: The 5-minute interval that contains the maximum number of steps is `r maxInterval` with an average of `r maxStep` steps  

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
